#!/bin/bash

set -e

if [ "$#" -lt 3 ]; then
  echo "Usage: create-new-addresses.sh <rpcuser> <rpcpassword> <wallet> <number> (optional, default: 100) <p2sh-segwit|bech32> (optional, default: bech32)"
  exit 1
fi

USER=$1
PW=$2
WALLET=$3

if [ "$#" -ge 4 ]; then
  ADDRCNT="$4"
else
  ADDRCNT=100
fi

if [ "$#" -ge 5 ]; then
  ADDRFMT="$5"
else
  ADDRFMT="bech32"
fi

for (( i = 0; i < ADDRCNT; i++ )); do
  bitcoin-cli -rpcuser="$USER" -rpcpassword="$PW" -rpcwallet="$WALLET" getnewaddress "" "$ADDRFMT"
done
